# EPUB è·¨å¹³å°å¤„ç†å·¥å…· â€” ä¿®è®¢æŠ€æœ¯æ–¹æ¡ˆ v2.1ï¼ˆåŸºäº wangyyyqw/epub å¯¹æ¯”åˆ†ææ›´æ–°ï¼‰

TS å…¨æ ˆé‡æ„ + Python ä»…ä¿ç•™å­—ä½“æ··æ·† + Tauri æ¡Œé¢åº”ç”¨ + CLI åŒç•Œé¢ + å€Ÿé‰´ä¼˜ç§€å¼€æºé¡¹ç›®

> **æœ¬æ–‡æ¡£çŠ¶æ€**ï¼šv2.1 - 2026-02-28 æ›´æ–°
> åŸºäº [wangyyyqw/epub](https://github.com/wangyyyqw/epub) å¯¹æ¯”åˆ†æï¼Œè¡¥å……æ ¸å¿ƒåŠŸèƒ½ï¼Œç§»é™¤ä¸å¿…è¦åŠŸèƒ½

---

## ä¸€ã€ä¸ v1 æ–¹æ¡ˆåŠå‚è€ƒé¡¹ç›®çš„å¯¹æ¯”

### 1.1 ä¸ v1 æ–¹æ¡ˆçš„å˜æ›´

| ç»´åº¦ | v1 æ–¹æ¡ˆ | v2.1 æ–¹æ¡ˆï¼ˆæœ¬æ–‡ï¼‰ |
|------|---------|------------------|
| Python ä¾èµ–èŒƒå›´ | 5 ä¸ªè„šæœ¬å…¨éƒ¨å¤ç”¨ | **ä»…ä¿ç•™ `encrypt_font.py`** |
| GUI æ–¹æ¡ˆ | Web UI | **Tauri æ¡Œé¢åº”ç”¨** |
| æ¶æ„ç­–ç•¥ | å…ˆå¤ç”¨ Python å†æŒ‰éœ€æ›¿æ¢ | **TS ä¸€æ¬¡æ€§é‡å†™åˆ°ä½**ï¼ˆå­—ä½“æ··æ·†é™¤å¤–ï¼‰ |
| å¯å¤ç”¨è„šæœ¬ | æ— ä¸“é—¨ç›®å½• | **`skills/` ç›®å½•** |
| åˆ†å‘ä½“ç§¯ | N/Aï¼ˆéœ€ç”¨æˆ·è£… Nodeï¼‰ | Tauri ~10-15MB |
| æ ¸å¿ƒåŠŸèƒ½ | åŸºç¡€ EPUB å¤„ç† | **+ TXTè½¬æ¢ã€ç®€ç¹è½¬æ¢ã€è¿œç¨‹å›¾ç‰‡** |

### 1.2 ä¸ wangyyyqw/epub çš„åŒºåˆ«

| ç»´åº¦ | wangyyyqw/epub | æœ¬é¡¹ç›® (v2.1) |
|------|----------------|--------------|
| GUI æ¡†æ¶ | Wails + Go | **Tauri + Rust** (æ›´è½»é‡) |
| æ ¸å¿ƒè¯­è¨€ | Python | **TypeScript** (ä¾èµ–æ›´å°‘) |
| å‰ç«¯æ¡†æ¶ | Vue 3 | React 18 + shadcn/ui |
| Python è§’è‰² | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ | **ä»…å­—ä½“æ··æ·†** |
| æ‹¼éŸ³æ³¨éŸ³ | âœ… æ”¯æŒ | âŒ **ä¸æ”¯æŒ**ï¼ˆç”¨æˆ·ä¸éœ€è¦ï¼‰ |
| TXT è½¬ EPUB | âœ… æ”¯æŒ | âœ… **å€Ÿé‰´å®ç°** |
| ç®€ç¹è½¬æ¢ | âœ… æ”¯æŒ | âœ… **å€Ÿé‰´å®ç°** (OpenCC.js) |
| ç¼–è¾‘å·¥ä½œæµ | âŒ æ—  | âœ… **åˆ›æ–°åŠŸèƒ½** (Git é›†æˆ) |
| Monorepo | âŒ æ—  | âœ… **pnpm workspace** |

> è¯¦ç»†å¯¹æ¯”åˆ†æè§ [comparison-with-wangyyyqw-epub.md](./comparison-with-wangyyyqw-epub.md)

---

## äºŒã€æ€»ä½“æ¶æ„ï¼ˆæ›´æ–°ï¼‰

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·ç•Œé¢å±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CLI (commander) â”‚    â”‚  Tauri Desktop App       â”‚  â”‚
â”‚  â”‚  ç»ˆç«¯ç›´æ¥ä½¿ç”¨     â”‚    â”‚  Rust å£³ + React å‰ç«¯    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                     â–¼                                â”‚
â”‚          æ ¸å¿ƒå¤„ç†å±‚ (packages/core/src/)  â† çº¯ TS     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ EPUB    â”‚ å›¾ç‰‡å¤„ç†  â”‚ å­—ä½“å¤„ç†  â”‚ ç¼–è¾‘å·¥ä½œæµâ”‚ TXT  â”‚ â”‚
â”‚   â”‚ è§£æ/æ‰“åŒ…â”‚ è½¬æ¢/å‹ç¼© â”‚ å­é›†åŒ–   â”‚ Git è·Ÿè¸ª  â”‚è½¬æ¢  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚           æ–°å¢æ¨¡å— (v2.1)                    â”‚   â”‚
â”‚   â”‚  Â· chinese/ - ç®€ç¹è½¬æ¢ (OpenCC.js)           â”‚   â”‚
â”‚   â”‚  Â· txt/ - TXT è§£æä¸ EPUB ç”Ÿæˆ               â”‚   â”‚
â”‚   â”‚  Â· image/download-remote.ts - è¿œç¨‹å›¾ç‰‡ä¸‹è½½   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                     â”‚                                â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚          â–¼          â–¼              â–¼                 â”‚
â”‚   TS åŸç”Ÿåº“    Python æ¡¥æ¥     å¤–éƒ¨ CLI å·¥å…·          â”‚
â”‚   Â· sharp      Â· encrypt_font  Â· jpegoptim           â”‚
â”‚   Â· subset-font  (å”¯ä¸€ Python)  Â· oxipng             â”‚
â”‚   Â· jszip                      Â· zopflipng           â”‚
â”‚   Â· cheerio                                          â”‚
â”‚   Â· css-tree                                         â”‚
â”‚   Â· simple-git                                       â”‚
â”‚   Â· opencc-js  â† æ–°å¢                                â”‚
â”‚   Â· axios      â† æ–°å¢                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒåŸåˆ™**ï¼š
1. TS åšä¸»åŠ›ï¼ŒPython ä»…åœ¨æ— æ›¿ä»£æ–¹æ¡ˆæ—¶ä½¿ç”¨
2. å€Ÿé‰´ wangyyyqw/epub çš„ä¼˜ç§€åŠŸèƒ½ï¼Œç”¨ TS é‡å†™
3. **æ˜ç¡®ä¸åš**ï¼šæ‹¼éŸ³æ³¨éŸ³åŠŸèƒ½ï¼ˆç”¨æˆ·æ˜ç¡®ä¸éœ€è¦ï¼‰

---

## ä¸‰ã€åŠŸèƒ½æ¸…å•ï¼ˆv2.1 æ›´æ–°ï¼‰

### 3.1 æ ¸å¿ƒåŠŸèƒ½ï¼ˆåŸè®¡åˆ’ï¼‰

| åŠŸèƒ½ | å®ç°æ¨¡å— | è¯´æ˜ |
|------|---------|------|
| EPUB æ ¼å¼åŒ– | `epub/reformat.ts` | é‡ç»„æ ‡å‡†ç›®å½•ç»“æ„ |
| EPUB åŠ å¯†/è§£å¯† | `crypto/` | æ–‡ä»¶ååŠ å¯†ï¼ˆTS é‡å†™ï¼‰ |
| å­—ä½“æ··æ·† | `font/encryptor.ts` | æ¡¥æ¥ Python |
| å­—ä½“å­é›†åŒ– | `font/subsetter.ts` | subset-font (TS) |
| å›¾ç‰‡å‹ç¼© | `image/compressor.ts` | jpegoptim/oxipng |
| WebP è½¬æ¢ | `image/webp-converter.ts` | sharp (åŒå‘) |
| EPUB2â†’3 å‡çº§ | `epub/upgrade.ts` | è‡ªåŠ¨ç‰ˆæœ¬å‡çº§ |
| ç¼–è¾‘å·¥ä½œæµ | `edit/` | Git é›†æˆï¼ˆåˆ›æ–°åŠŸèƒ½ï¼‰ |

### 3.2 æ–°å¢åŠŸèƒ½ï¼ˆå€Ÿé‰´ wangyyyqw/epubï¼‰â­

| åŠŸèƒ½ | å®ç°æ¨¡å— | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|---------|--------|------|
| **TXT â†’ EPUB** | `txt/txt-parser.ts` + `txt/epub-creator.ts` | **é«˜** â­â­â­ | è‡ªåŠ¨ç« èŠ‚è¯†åˆ«ï¼Œåˆ†å±‚ç›®å½• |
| **ç®€ç¹è½¬æ¢** | `chinese/converter.ts` (OpenCC.js) | **é«˜** â­â­â­ | è¯ç»„çº§ç²¾ç¡®è½¬æ¢ |
| **ä¸‹è½½è¿œç¨‹å›¾ç‰‡** | `image/download-remote.ts` (axios + sharp) | **é«˜** â­â­â­ | EPUB ç½‘ç»œèµ„æºæœ¬åœ°åŒ– |
| **æ­£åˆ™æ³¨é‡Š/è„šæ³¨** | `skills/ts/regex-annotate.ts` | ä¸­ â­â­ | é«˜çº§ç¼–è¾‘åŠŸèƒ½ |
| **EPUB åˆå¹¶** | `skills/ts/merge-epub.ts` | ä¸­ â­â­ | å¤šå·ä¹¦ç±åˆå¹¶ |
| **EPUB æ‹†åˆ†** | `skills/ts/split-epub.ts` | ä¸­ â­â­ | æŒ‰ç« èŠ‚æ‹†åˆ† |

### 3.3 æ˜ç¡®ä¸åšçš„åŠŸèƒ½ âŒ

| åŠŸèƒ½ | ç†ç”± |
|------|------|
| æ‹¼éŸ³æ³¨éŸ³ | ç”¨æˆ·æ˜ç¡®è¡¨ç¤ºä¸éœ€è¦ |
| ç”Ÿåƒ»å­—æ³¨éŸ³ | ä¸æ‹¼éŸ³åŠŸèƒ½ç›¸å…³ |
| æ‹¼éŸ³å­—å…¸ | æ‹¼éŸ³åŠŸèƒ½çš„ä¾èµ–æ•°æ® |

---

## å››ã€é¡¹ç›®ç»“æ„ï¼ˆv2.1 æ›´æ–°ï¼‰

```text
epub-tools/
â”œâ”€â”€ package.json
â”œâ”€â”€ pnpm-workspace.yaml
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ README.md
â”œâ”€â”€ setup.sh / setup.ps1
â”‚
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/                       # æ ¸å¿ƒå¤„ç†åº“ï¼ˆçº¯ TSï¼‰
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ index.ts
â”‚   â”‚       â”œâ”€â”€ epub/
â”‚   â”‚       â”‚   â”œâ”€â”€ parser.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ writer.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ reformat.ts
â”‚   â”‚       â”‚   â””â”€â”€ upgrade.ts
â”‚   â”‚       â”œâ”€â”€ image/
â”‚   â”‚       â”‚   â”œâ”€â”€ webp-converter.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ compressor.ts
â”‚   â”‚       â”‚   â””â”€â”€ download-remote.ts    # â­ æ–°å¢
â”‚   â”‚       â”œâ”€â”€ font/
â”‚   â”‚       â”‚   â”œâ”€â”€ subsetter.ts
â”‚   â”‚       â”‚   â””â”€â”€ encryptor.ts
â”‚   â”‚       â”œâ”€â”€ crypto/
â”‚   â”‚       â”‚   â”œâ”€â”€ encrypt.ts
â”‚   â”‚       â”‚   â””â”€â”€ decrypt.ts
â”‚   â”‚       â”œâ”€â”€ txt/                      # â­ æ–°å¢æ¨¡å—
â”‚   â”‚       â”‚   â”œâ”€â”€ txt-parser.ts         # TXT è§£æ
â”‚   â”‚       â”‚   â”œâ”€â”€ chapter-splitter.ts   # ç« èŠ‚åˆ†å‰²
â”‚   â”‚       â”‚   â””â”€â”€ epub-creator.ts       # ç”Ÿæˆ EPUB
â”‚   â”‚       â”œâ”€â”€ chinese/                  # â­ æ–°å¢æ¨¡å—
â”‚   â”‚       â”‚   â””â”€â”€ converter.ts          # ç®€ç¹è½¬æ¢
â”‚   â”‚       â”œâ”€â”€ edit/
â”‚   â”‚       â”‚   â”œâ”€â”€ workspace.ts
â”‚   â”‚       â”‚   â”œâ”€â”€ watcher.ts
â”‚   â”‚       â”‚   â””â”€â”€ packer.ts
â”‚   â”‚       â”œâ”€â”€ bridge/
â”‚   â”‚       â”‚   â””â”€â”€ python-runner.ts
â”‚   â”‚       â””â”€â”€ utils/
â”‚   â”‚           â”œâ”€â”€ logger.ts
â”‚   â”‚           â”œâ”€â”€ config.ts
â”‚   â”‚           â””â”€â”€ tool-checker.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ cli/                        # CLI å…¥å£
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ index.ts
â”‚   â”‚       â””â”€â”€ commands/
â”‚   â”‚           â”œâ”€â”€ process.ts
â”‚   â”‚           â”œâ”€â”€ convert-webp.ts
â”‚   â”‚           â”œâ”€â”€ compress.ts
â”‚   â”‚           â”œâ”€â”€ reformat.ts
â”‚   â”‚           â”œâ”€â”€ encrypt.ts
â”‚   â”‚           â”œâ”€â”€ decrypt.ts
â”‚   â”‚           â”œâ”€â”€ encrypt-font.ts
â”‚   â”‚           â”œâ”€â”€ subset-fonts.ts
â”‚   â”‚           â”œâ”€â”€ txt-to-epub.ts        # â­ æ–°å¢
â”‚   â”‚           â”œâ”€â”€ chinese-convert.ts    # â­ æ–°å¢
â”‚   â”‚           â”œâ”€â”€ download-images.ts    # â­ æ–°å¢
â”‚   â”‚           â”œâ”€â”€ edit.ts
â”‚   â”‚           â”œâ”€â”€ doctor.ts
â”‚   â”‚           â””â”€â”€ gui.ts
â”‚   â”‚
â”‚   â””â”€â”€ gui/                        # Tauri æ¡Œé¢åº”ç”¨
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ vite.config.ts
â”‚       â”œâ”€â”€ src/                    # React å‰ç«¯
â”‚       â”‚   â”œâ”€â”€ App.tsx
â”‚       â”‚   â”œâ”€â”€ components/
â”‚       â”‚   â”‚   â”œâ”€â”€ FileList.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ ActionBar.tsx         # â­ æ›´æ–°ï¼šæ–°å¢æŒ‰é’®
â”‚       â”‚   â”‚   â”œâ”€â”€ LogPanel.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ ProgressBar.tsx
â”‚       â”‚   â”‚   â””â”€â”€ SettingsDialog.tsx
â”‚       â”‚   â””â”€â”€ lib/
â”‚       â”‚       â””â”€â”€ tauri-bridge.ts
â”‚       â””â”€â”€ src-tauri/              # Rust åç«¯
â”‚           â”œâ”€â”€ Cargo.toml
â”‚           â”œâ”€â”€ tauri.conf.json
â”‚           â””â”€â”€ src/
â”‚               â”œâ”€â”€ main.rs
â”‚               â”œâ”€â”€ commands.rs
â”‚               â””â”€â”€ sidecar.rs
â”‚
â”œâ”€â”€ py-scripts/                     # Python è„šæœ¬ï¼ˆä»…å­—ä½“æ··æ·†ï¼‰
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ encrypt_font.py
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ log.py
â”‚
â”œâ”€â”€ skills/                         # å¯å¤ç”¨ç‹¬ç«‹è„šæœ¬
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ ts/
â”‚   â”‚   â”œâ”€â”€ batch-rename.ts
â”‚   â”‚   â”œâ”€â”€ extract-toc.ts
â”‚   â”‚   â”œâ”€â”€ find-broken-links.ts
â”‚   â”‚   â”œâ”€â”€ strip-metadata.ts
â”‚   â”‚   â”œâ”€â”€ epub-info.ts
â”‚   â”‚   â”œâ”€â”€ image-audit.ts
â”‚   â”‚   â”œâ”€â”€ css-cleanup.ts
â”‚   â”‚   â”œâ”€â”€ charset-scan.ts
â”‚   â”‚   â”œâ”€â”€ regex-replace.ts
â”‚   â”‚   â”œâ”€â”€ txt-to-epub.ts            # â­ æ–°å¢ï¼ˆCLI å…¥å£ï¼‰
â”‚   â”‚   â”œâ”€â”€ chinese-convert.ts        # â­ æ–°å¢ï¼ˆCLI å…¥å£ï¼‰
â”‚   â”‚   â”œâ”€â”€ regex-annotate.ts         # â­ æ–°å¢
â”‚   â”‚   â”œâ”€â”€ merge-epub.ts             # â­ æ–°å¢
â”‚   â”‚   â””â”€â”€ split-epub.ts             # â­ æ–°å¢
â”‚   â””â”€â”€ py/
â”‚       â”œâ”€â”€ font-info.py
â”‚       â”œâ”€â”€ font-diff.py
â”‚       â””â”€â”€ glyph-preview.py
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ plan-epubToolsV2.prompt.md            # åŸå§‹è®¡åˆ’
â”‚   â”œâ”€â”€ plan-epubToolsV2-updated.md           # â­ æœ¬æ–‡æ¡£
â”‚   â””â”€â”€ comparison-with-wangyyyqw-epub.md     # â­ å¯¹æ¯”åˆ†æ
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ fixtures/
    â”œâ”€â”€ core/
    â”œâ”€â”€ cli/
    â””â”€â”€ skills/
```

---

## äº”ã€æŠ€æœ¯æ ˆæ¸…å•ï¼ˆv2.1 æ›´æ–°ï¼‰

### 5.1 æ ¸å¿ƒåº“ï¼ˆ`packages/core`ï¼‰

| åŒ… | ç”¨é€” | ç‰ˆæœ¬è¦æ±‚ |
|----|------|---------|
| `sharp` | å›¾ç‰‡æ ¼å¼è½¬æ¢ä¸å‹ç¼© | latest |
| `subset-font` | å­—ä½“å­é›†åŒ– | latest |
| `cheerio` | HTML/XHTML è§£æ | latest |
| `fast-xml-parser` | XML/OPF è§£æ | latest |
| `css-tree` | CSS è§£æä¸ä¿®æ”¹ | latest |
| `jszip` | EPUB ZIP è¯»å†™ | latest |
| `simple-git` | Git æ“ä½œ | latest |
| `chokidar` | æ–‡ä»¶ç›‘å¬ | latest |
| `string-similarity` | æ¨¡ç³ŠåŒ¹é… | latest |
| **`opencc-js`** â­ | **ç®€ç¹è½¬æ¢** | **latest** |
| **`axios`** â­ | **HTTP è¯·æ±‚ï¼ˆä¸‹è½½å›¾ç‰‡ï¼‰** | **latest** |

### 5.2 å¼€å‘ä¸æµ‹è¯•

| åŒ… | ç”¨é€” |
|----|------|
| `fast-check` â­ | å±æ€§æµ‹è¯•ï¼ˆå€Ÿé‰´ wangyyyqw/epubï¼‰ |
| `vitest` | å•å…ƒæµ‹è¯• |
| `tsx` | TS æ‰§è¡Œå™¨ |

### 5.3 å¤–éƒ¨å·¥å…·

| å·¥å…· | ç”¨é€” | å¿…è£…ï¼Ÿ |
|------|------|--------|
| `jpegoptim` | JPEG æ— æŸä¼˜åŒ– | æ¨è |
| `oxipng` | PNG å¿«é€Ÿå‹ç¼© | æ¨è |
| `zopflipng` | PNG æé™å‹ç¼© | å¯é€‰ |

### 5.4 Pythonï¼ˆä»…å­—ä½“æ··æ·†ï¼‰

| åŒ… | ç”¨é€” |
|----|------|
| `fonttools` | å­—ä½“æ“ä½œ |
| `beautifulsoup4` | HTML è§£æ |
| `tinycss2` | CSS è§£æ |

---

## å…­ã€CLI è®¾è®¡ï¼ˆv2.1 æ›´æ–°ï¼‰

```bash
# === ä¸€é”®å¤„ç† ===
epub-tools process book.epub -o output/ --convert-webp --compress --subset-fonts

# === å•é¡¹åŠŸèƒ½ï¼ˆåŸæœ‰ï¼‰ ===
epub-tools convert-webp book.epub -o output/
epub-tools compress book.epub -o output/ --level balanced
epub-tools subset-fonts book.epub -o output/
epub-tools reformat book.epub -o output/
epub-tools encrypt book.epub -o output/
epub-tools decrypt book.epub -o output/
epub-tools encrypt-font book.epub -o output/

# === æ–°å¢åŠŸèƒ½ â­ ===
epub-tools txt-to-epub book.txt -o book.epub           # TXT è½¬ EPUB
epub-tools chinese-convert book.epub -o output/ --to traditional  # ç®€â†’ç¹
epub-tools chinese-convert book.epub -o output/ --to simplified   # ç¹â†’ç®€
epub-tools download-images book.epub -o output/        # ä¸‹è½½è¿œç¨‹å›¾ç‰‡

# === ç¼–è¾‘å·¥ä½œæµ ===
epub-tools edit book.epub
epub-tools watch ~/.epub-workspace/book/
epub-tools pack ~/.epub-workspace/book/ -o out.epub

# === Skills ===
epub-tools skill txt-to-epub book.txt                  # â­ æ–°å¢
epub-tools skill chinese-convert book.epub --to traditional
epub-tools skill regex-annotate book.epub              # â­ æ–°å¢
epub-tools skill merge-epub book1.epub book2.epub      # â­ æ–°å¢
epub-tools skill split-epub book.epub                  # â­ æ–°å¢
epub-tools skill epub-info book.epub
epub-tools skill charset-scan book.epub
epub-tools skill list

# === å·¥å…· ===
epub-tools doctor
epub-tools gui
```

---

## ä¸ƒã€GUI å¸ƒå±€ï¼ˆv2.1 æ›´æ–°ï¼‰

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EPUB Tools                                    [è®¾ç½®] [ä¸»é¢˜] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                                  â”‚
â”‚  ä¾§è¾¹æ    â”‚  ğŸ“‚ å¾…å¤„ç†æ–‡ä»¶                                    â”‚
â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ [æ·»åŠ æ–‡ä»¶] â”‚  â”‚  #  æ–‡ä»¶å           è·¯å¾„              çŠ¶æ€  â”‚    â”‚
â”‚ [æ·»åŠ æ–‡ä»¶å¤¹]â”‚  â”‚  1  book1.epub      /Users/.../book1  å¾…å¤„ç†â”‚    â”‚
â”‚ [æ¸…ç©ºåˆ—è¡¨] â”‚  â”‚  2  book.txt        /Users/.../book   å¾…å¤„ç†â”‚ â­ â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                                                  â”‚
â”‚          â”‚  ğŸ“ è¾“å‡ºè·¯å¾„: [é»˜è®¤: æºæ–‡ä»¶åŒçº§ç›®å½•] [é€‰æ‹©] [é‡ç½®]   â”‚
â”‚ ä½¿ç”¨è¯´æ˜  â”‚                                                  â”‚
â”‚ Â· æ‹–æ‹½æ·»åŠ â”‚  ğŸ”§ æ“ä½œ                                          â”‚
â”‚ Â· å³é”®èœå•â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åŸºç¡€åŠŸèƒ½ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ Â· TXTæ–‡ä»¶ â”‚  â”‚[æ ¼å¼åŒ–] [è§£å¯†] [åŠ å¯†] [å­—ä½“åŠ å¯†]              â”‚â”‚
â”‚          â”‚  â”‚[å›¾ç‰‡è½¬æ¢] [å›¾ç‰‡å‹ç¼©â–¾] [å­—ä½“å­é›†åŒ–]            â”‚â”‚
â”‚ GitHub â†— â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ–°å¢åŠŸèƒ½ â­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚          â”‚  â”‚[TXTâ†’EPUB] [ç®€ç¹è½¬æ¢] [ä¸‹è½½è¿œç¨‹å›¾ç‰‡]          â”‚â”‚
â”‚          â”‚  â”‚[EPUBåˆå¹¶] [EPUBæ‹†åˆ†] [æ­£åˆ™æ³¨é‡Š]              â”‚â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚          â”‚                                                  â”‚
â”‚          â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  75%  å¤„ç†ä¸­...          â”‚
â”‚          â”‚                                                  â”‚
â”‚          â”‚  ğŸ“‹ æ‰§è¡Œæ—¥å¿—                                       â”‚
â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚          â”‚  â”‚ âœ… book1.epub  å›¾ç‰‡è½¬æ¢æˆåŠŸ                â”‚    â”‚
â”‚          â”‚  â”‚ âœ… book.txt   è½¬æ¢ä¸º EPUB æˆåŠŸ  â­         â”‚    â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ–°å¢åŠŸèƒ½è¯´æ˜**ï¼š
- **TXTâ†’EPUB**ï¼šæ”¯æŒ `.txt` æ–‡ä»¶æ‹–æ‹½ï¼Œè‡ªåŠ¨ç« èŠ‚è¯†åˆ«
- **ç®€ç¹è½¬æ¢**ï¼šåŸºäº OpenCC.jsï¼Œè¯ç»„çº§ç²¾ç¡®è½¬æ¢
- **ä¸‹è½½è¿œç¨‹å›¾ç‰‡**ï¼šEPUB å†… `<img src="http://...">` è‡ªåŠ¨ä¸‹è½½å¹¶æœ¬åœ°åŒ–
- **EPUBåˆå¹¶/æ‹†åˆ†**ï¼šå¤šå·ä¹¦ç±å¤„ç†
- **æ­£åˆ™æ³¨é‡Š**ï¼šæ ¹æ®æ­£åˆ™è§„åˆ™æ‰¹é‡æ·»åŠ æ³¨é‡Š/è„šæ³¨

---

## å…«ã€å®æ–½è®¡åˆ’ï¼ˆv2.1 æ›´æ–°ï¼‰

### Sprint 1ï¼šMonorepo éª¨æ¶ + EPUB æ ¸å¿ƒï¼ˆ2 å¤©ï¼‰

- [ ] åˆå§‹åŒ– pnpm workspace monorepo
- [ ] `packages/core`: EPUB è§£æå™¨/æ‰“åŒ…å™¨
- [ ] `packages/cli`: åŸºç¡€éª¨æ¶ + `doctor` å‘½ä»¤
- [ ] `skills/` ç›®å½•åˆå§‹åŒ–
- [ ] å·¥å…·æ£€æµ‹ï¼ˆ`tool-checker.ts`ï¼‰

### Sprint 2ï¼šTS é‡å†™ â€” å›¾ç‰‡ + æ ¼å¼åŒ– + åŠ è§£å¯†ï¼ˆ3-4 å¤©ï¼‰

- [ ] `epub/reformat.ts` â€” TS é‡å†™
- [ ] `image/webp-converter.ts` â€” sharp WebP è½¬æ¢
- [ ] `image/compressor.ts` â€” å›¾ç‰‡å‹ç¼©å°è£…
- [ ] `crypto/encrypt.ts` + `decrypt.ts` â€” åŠ å¯†è§£å¯†
- [ ] `epub/upgrade.ts` â€” EPUB2 â†’ EPUB3.2
- [ ] CLI å‘½ä»¤å¯¹æ¥

### **Sprint 2.5ï¼šå€Ÿé‰´åŠŸèƒ½å®ç°ï¼ˆ3-4 å¤©ï¼‰â­ æ–°å¢**

- [ ] **TXT â†’ EPUB**ï¼š
  - [ ] `txt/txt-parser.ts` â€” TXT è§£æ
  - [ ] `txt/chapter-splitter.ts` â€” è‡ªåŠ¨ç« èŠ‚è¯†åˆ«ï¼ˆæ­£åˆ™ï¼‰
  - [ ] `txt/epub-creator.ts` â€” ç”Ÿæˆ EPUB ç»“æ„
  - [ ] CLI å‘½ä»¤ï¼š`txt-to-epub`
  - [ ] GUI æŒ‰é’®ï¼šæ”¯æŒ `.txt` æ–‡ä»¶æ‹–æ‹½
- [ ] **ç®€ç¹è½¬æ¢**ï¼š
  - [ ] `chinese/converter.ts` â€” OpenCC.js å°è£…
  - [ ] CLI å‘½ä»¤ï¼š`chinese-convert`
  - [ ] GUI æŒ‰é’®ï¼šç®€ç¹è½¬æ¢
- [ ] **ä¸‹è½½è¿œç¨‹å›¾ç‰‡**ï¼š
  - [ ] `image/download-remote.ts` â€” axios + sharp
  - [ ] é›†æˆåˆ°å›¾ç‰‡å¤„ç†æµç¨‹
  - [ ] GUI æŒ‰é’®
- [ ] **æ­£åˆ™æ³¨é‡Š/è„šæ³¨**ï¼š
  - [ ] `skills/ts/regex-annotate.ts`
  - [ ] GUI é«˜çº§åŠŸèƒ½åŒº
- [ ] **EPUB åˆå¹¶/æ‹†åˆ†**ï¼š
  - [ ] `skills/ts/merge-epub.ts`
  - [ ] `skills/ts/split-epub.ts`
  - [ ] CLI å‘½ä»¤ + GUI æŒ‰é’®

### Sprint 3ï¼šå­—ä½“å¤„ç† + Python æ¡¥æ¥ï¼ˆ2 å¤©ï¼‰

- [ ] `font/subsetter.ts` â€” subset-font
- [ ] `font/encryptor.ts` + `bridge/python-runner.ts`
- [ ] å¤åˆ¶ `encrypt_font.py` åˆ° `py-scripts/`
- [ ] CLI å‘½ä»¤ï¼š`encrypt-font`, `subset-fonts`

### Sprint 4ï¼šç¼–è¾‘å·¥ä½œæµ + ä¸€é”®æµæ°´çº¿ï¼ˆ2 å¤©ï¼‰

- [ ] `edit/workspace.ts` + Git é›†æˆ
- [ ] `edit/watcher.ts` â€” chokidar + simple-git
- [ ] `edit/packer.ts`
- [ ] `process` ä¸€é”®å‘½ä»¤
- [ ] æ‰¹é‡å¤„ç† `--recursive`

### Sprint 5ï¼šSkills è„šæœ¬ï¼ˆ1-2 å¤©ï¼‰

- [ ] TS skillsï¼š`epub-info`, `charset-scan`, `find-broken-links`
- [ ] Python skillsï¼š`font-info.py`
- [ ] CLI `skill` å­å‘½ä»¤

### Sprint 6ï¼šTauri GUIï¼ˆ4-5 å¤©ï¼‰

- [ ] Tauri é¡¹ç›®åˆå§‹åŒ–
- [ ] React + TailwindCSS + shadcn/ui
- [ ] å‰ç«¯ç»„ä»¶ï¼ˆå«æ–°å¢åŠŸèƒ½æŒ‰é’®ï¼‰
- [ ] Rust åç«¯ IPC + sidecar
- [ ] Node.js SEA ç¼–è¯‘
- [ ] æ·±è‰²/æµ…è‰²ä¸»é¢˜

### Sprint 7ï¼šæµ‹è¯• + CI/CD + æ–‡æ¡£ï¼ˆ2 å¤©ï¼‰

- [ ] vitest å•å…ƒæµ‹è¯•
- [ ] **fast-check å±æ€§æµ‹è¯•** â­ æ–°å¢
- [ ] GitHub Actionsï¼šä¸‰å¹³å°æµ‹è¯• + Tauri æ„å»º
- [ ] READMEï¼ˆä¸­è‹±æ–‡ï¼‰
- [ ] setup.sh / setup.ps1

---

## ä¹ã€æµ‹è¯•ç­–ç•¥ï¼ˆv2.1 æ–°å¢ï¼‰

### 9.1 å•å…ƒæµ‹è¯• (vitest)

å¸¸è§„åŠŸèƒ½æµ‹è¯•ï¼š
- EPUB è§£æ/æ‰“åŒ…æ­£ç¡®æ€§
- è·¯å¾„æ˜ å°„å‡†ç¡®æ€§
- åŠ å¯†/è§£å¯†å¯é€†æ€§

### 9.2 å±æ€§æµ‹è¯• (fast-check) â­ å€Ÿé‰´ wangyyyqw/epub

æµ‹è¯•ä¸å˜æ€§ (Invariants)ï¼š
```typescript
// ç¤ºä¾‹ï¼šEPUB æ‰“åŒ…/è§£åŒ…åº”ä¿æŒæ–‡ä»¶ä¸€è‡´
test('EPUB pack/unpack roundtrip', () => {
  fc.assert(
    fc.property(fc.epubFixture(), async (epub) => {
      const packed = await packEpub(epub);
      const unpacked = await unpackEpub(packed);
      expect(unpacked).toEqual(epub);
    })
  );
});

// ç¤ºä¾‹ï¼šè·¯å¾„æ˜ å°„åº”ä¿æŒå¼•ç”¨å®Œæ•´æ€§
test('path remap preserves references', () => {
  fc.assert(
    fc.property(fc.pathMap(), fc.htmlContent(), (pathMap, html) => {
      const remapped = remapPaths(html, pathMap);
      const links = extractLinks(remapped);
      expect(links.every(link => pathMap.has(link))).toBe(true);
    })
  );
});
```

### 9.3 é›†æˆæµ‹è¯•

- TXT â†’ EPUB ç”Ÿæˆçš„æ–‡ä»¶èƒ½å¦è¢« Calibre/Sigil æ‰“å¼€
- ç®€ç¹è½¬æ¢çš„è¯ç»„çº§å‡†ç¡®æ€§
- ä¸‹è½½è¿œç¨‹å›¾ç‰‡çš„å®Œæ•´æ€§

---

## åã€ä¾èµ–ç¯å¢ƒè¦æ±‚ï¼ˆv2.1 æ›´æ–°ï¼‰

### å¼€å‘ç¯å¢ƒ

```text
å¿…é¡»ï¼šNode.js 22+, pnpm 10+
æ„å»º GUIï¼šRust toolchain (rustup)
æ¨èï¼šjpegoptim, oxipng
å¯é€‰ï¼šPython 3.9+ï¼ˆå­—ä½“æ··æ·†åŠŸèƒ½ï¼‰
å¯é€‰ï¼šzopflipngï¼ˆPNG æé™å‹ç¼©ï¼‰
```

### æœ€ç»ˆç”¨æˆ·ï¼ˆTauri æ‰“åŒ…åº”ç”¨ï¼‰

```text
æ— éœ€ï¼šNode.js / Rust
å­—ä½“æ··æ·†ï¼šéœ€ç³»ç»Ÿ Python 3.9+
å›¾ç‰‡å‹ç¼©ï¼šéœ€ jpegoptim / oxipngï¼ˆåº”ç”¨å†…æä¾›å®‰è£…å¼•å¯¼ï¼‰
```

---

## åä¸€ã€æ€»ç»“

### v2.1 æ ¸å¿ƒå˜æ›´

1. âœ… **æ–°å¢ TXT â†’ EPUB è½¬æ¢**ï¼ˆå€Ÿé‰´ wangyyyqw/epubï¼‰
2. âœ… **æ–°å¢ç®€ç¹è½¬æ¢**ï¼ˆOpenCC.jsï¼Œè¯ç»„çº§ç²¾ç¡®ï¼‰
3. âœ… **æ–°å¢è¿œç¨‹å›¾ç‰‡ä¸‹è½½**ï¼ˆç½‘ç»œèµ„æºæœ¬åœ°åŒ–ï¼‰
4. âœ… **æ–°å¢ EPUB åˆå¹¶/æ‹†åˆ†**ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
5. âœ… **æ–°å¢æ­£åˆ™æ³¨é‡Š/è„šæ³¨**ï¼ˆæ‰¹é‡ç¼–è¾‘ï¼‰
6. âœ… **å¼•å…¥å±æ€§æµ‹è¯•**ï¼ˆfast-checkï¼Œæå‡è´¨é‡ï¼‰
7. âŒ **æ˜ç¡®ä¸åšæ‹¼éŸ³æ³¨éŸ³**ï¼ˆç”¨æˆ·ä¸éœ€è¦ï¼‰

### æŠ€æœ¯ä¼˜åŠ¿

- **TS ä¼˜å…ˆ**ï¼šæ ¸å¿ƒé€»è¾‘å…¨ TSï¼Œä¾èµ–å°‘
- **Tauri è½»é‡**ï¼š10-15MB æ‰“åŒ…ä½“ç§¯
- **Monorepo**ï¼šä»£ç ç»„ç»‡æ¸…æ™°
- **Skills ä½“ç³»**ï¼šå¯å¤ç”¨å·¥å…·é›†
- **åˆ›æ–°åŠŸèƒ½**ï¼šç¼–è¾‘å·¥ä½œæµ + Git é›†æˆ

### å€Ÿé‰´æœ€ä½³å®è·µ

- **TXT è½¬æ¢**ï¼šè‡ªåŠ¨ç« èŠ‚è¯†åˆ«é€»è¾‘ä¼˜ç§€
- **ç®€ç¹è½¬æ¢**ï¼šè¯ç»„çº§è½¬æ¢ç²¾åº¦é«˜
- **å±æ€§æµ‹è¯•**ï¼šä¿è¯è¾¹ç•Œæƒ…å†µæ­£ç¡®æ€§
- **æ’ä»¶æ¶æ„**ï¼šä¾¿äºåŠŸèƒ½æ‰©å±•

---

**ç»“è®º**ï¼šv2.1 æ–¹æ¡ˆåœ¨ä¿æŒæŠ€æœ¯æ ˆä¼˜åŠ¿çš„å‰æä¸‹ï¼Œé€‰æ‹©æ€§å¼•å…¥ wangyyyqw/epub çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆTXT è½¬æ¢ã€ç®€ç¹è½¬æ¢ã€è¿œç¨‹å›¾ç‰‡ï¼‰ï¼ŒåŒæ—¶æ˜ç¡®æ’é™¤ä¸å¿…è¦çš„æ‹¼éŸ³åŠŸèƒ½ï¼Œå½¢æˆæ›´å®Œå–„çš„ EPUB å·¥å…·é“¾ã€‚
